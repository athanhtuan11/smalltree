{% extends "flashcard/base.html" %}

{% block title %}Th√™m th·∫ª m·ªõi - {{ deck.title }}{% endblock %}

{% block content %}
<div class="container" style="padding: 40px 20px; max-width: 800px; margin: 0 auto;">
    <div style="margin-bottom: 20px;">
        <a href="{{ url_for('flashcard.manage_cards', deck_id=deck.id) }}" class="btn btn-outline-success">
            <i class="bi bi-arrow-left me-2"></i>Quay l·∫°i Qu·∫£n l√Ω th·∫ª
        </a>
    </div>
    
    <div style="background: white; border-radius: 25px; padding: 40px; box-shadow: 0 8px 20px var(--shadow);">
        <h1 style="text-align: center; font-size: 2.5rem; margin-bottom: 10px;">‚û• Th√™m th·∫ª m·ªõi</h1>
        <p style="text-align: center; color: #666; margin-bottom: 30px;">B·ªô: {{ deck.title }}</p>
        
        <form method="POST" enctype="multipart/form-data">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            <div class="mb-4">
                <label class="form-label" style="font-size: 1.2rem; font-weight: bold;">T·ª´/C·ª•m t·ª´ ch√≠nh *</label>
                <input type="text" name="front_text" class="form-control form-control-lg" placeholder="VD: Dog, Con ch√≥, M√†u ƒë·ªè..." required>
                <small class="text-muted">T·ª´ n√†y s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã v√† ƒë·ªçc cho tr·∫ª nghe</small>
            </div>
            
            <div class="mb-4">
                <label class="form-label" style="font-size: 1.2rem; font-weight: bold;">Gi·∫£i th√≠ch th√™m (t√πy ch·ªçn)</label>
                <input type="text" name="back_text" class="form-control" placeholder="VD: ƒê·ªông v·∫≠t 4 ch√¢n, c√≥ ƒëu√¥i...">
            </div>
            
            <div class="mb-4">
                <label class="form-label" style="font-size: 1.2rem; font-weight: bold;">H√¨nh ·∫£nh *</label>
                <input type="file" name="image" class="form-control" accept="image/*" required id="imageInput">
                <small class="text-muted">ƒê·ªãnh d·∫°ng: JPG, PNG, WEBP. N√™n d√πng h√¨nh l·ªõn, r√µ n√©t</small>
                <div id="imagePreview" style="margin-top: 15px;"></div>
            </div>
            
            <div class="mb-4">
                <label class="form-label" style="font-size: 1.2rem; font-weight: bold;">Audio (t√πy ch·ªçn)</label>
                <input type="file" name="audio" class="form-control" accept="audio/*" id="audioInput">
                <small class="text-muted">ƒê·ªãnh d·∫°ng: MP3, WAV, M4A. N·∫øu kh√¥ng c√≥, h·ªá th·ªëng s·∫Ω d√πng Text-to-Speech</small>
                <div id="audioPreview" style="margin-top: 10px;"></div>
            </div>
            
            <div style="background: linear-gradient(135deg, var(--pastel-yellow), white); padding: 20px; border-radius: 15px; margin-bottom: 30px;">
                <strong>üí° M·∫πo:</strong>
                <ul style="margin-bottom: 0; margin-top: 10px;">
                    <li>D√πng h√¨nh ·∫£nh ch·∫•t l∆∞·ª£ng cao, r√µ n√©t</li>
                    <li>Ghi √¢m v·ªõi gi·ªçng c√¥ gi√°o s·∫Ω th√¢n thi·ªán h∆°n gi·ªçng m√°y</li>
                    <li>√Çm thanh n√™n ƒë·ªçc ch·∫≠m, r√µ r√†ng cho tr·∫ª nh·ªè</li>
                </ul>
            </div>
            
            <div style="text-align: center; margin-top: 40px;">
                <button type="submit" class="btn-control btn-finish" style="font-size: 1.3rem; padding: 15px 50px;">
                    ‚úÖ Th√™m th·∫ª
                </button>
                <a href="{{ url_for('flashcard.manage_cards', deck_id=deck.id) }}" class="btn-control btn-prev" style="font-size: 1.3rem; padding: 15px 50px;">
                    ‚ùå H·ªßy
                </a>
            </div>
        </form>
    </div>
</div>

<script>
// Preview h√¨nh ·∫£nh
document.getElementById('imageInput').addEventListener('change', function(e) {
    const file = e.target.files[0];
    if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            document.getElementById('imagePreview').innerHTML = `
                <img src="${e.target.result}" style="max-width: 300px; border-radius: 15px; box-shadow: 0 4px 10px var(--shadow);">
            `;
        };
        reader.readAsDataURL(file);
    }
});

// Preview audio
document.getElementById('audioInput').addEventListener('change', function(e) {
    const file = e.target.files[0];
    if (file) {
        const url = URL.createObjectURL(file);
        document.getElementById('audioPreview').innerHTML = `
            <audio controls style="width: 100%; margin-top: 10px;">
                <source src="${url}" type="${file.type}">
            </audio>
        `;
    }
});
</script>
{% endblock %}
